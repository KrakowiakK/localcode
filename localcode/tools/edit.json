{
  "name": "edit",
  "aliases": [
    "replace_in_file",
    "edit_file"
  ],
  "category": "write",
  "description": "Replace a targeted snippet in an existing file.\n\nTwo valid modes:\n1) Classic exact replace: {\"path\":\"file.js\",\"old\":\"before\",\"new\":\"after\"}\n2) Hashline anchor replace: {\"path\":\"file.js\",\"old_start\":\"42:ab12\",\"old_end\":\"45:9f3c\",\"new\":\"replacement block\"}\n\nUse classic mode for straightforward replacements. Use anchor mode when exact old text is unstable but you have line/hash references from read(format=\"hashline\").\n\nAccepted arg aliases:\n- old_str / old_string -> old\n- new_str / new_string -> new\n- line_start/start_line/line/start/start_ref -> old_start\n- line_end/end_line/end/end_ref -> old_end",
  "feedback": {
    "must_read_before_editing": "FORMAT ERROR: {{tool:edit}} failed due to stale context.\nACTION: Call {{tool:read}}(path) for {{target}}, then retry {{tool:edit}} with exact current text.",
    "old_string_not_found": "ERROR: 'old' string not found in file. Common causes:\n1. Whitespace mismatch (tabs vs spaces, trailing spaces)\n2. String was modified since last read\n3. Guessing content instead of copying from read output\nACTION: Call {{tool:read}}({{target}}), then COPY the exact substring. If the change is broad, use a larger exact old/new block.",
    "old_string_not_unique": "FORMAT ERROR: {{tool:edit}} failed: old_string is not unique.\nACTION: Call {{tool:read}}(path) for {{target}} (use {{tool:read}}, NOT {{tool:search}}), then retry with an exact unique substring, OR set all=true if you intend to replace all occurrences.",
    "old_equals_new": "ERROR: {{tool:edit}} called with 'old' identical to 'new' - no change would occur.\nThis usually means you want to MODIFY the code, not copy it unchanged.\nACTION:\n1. Re-read the file with {{tool:read}}({{target}})\n2. Identify the EXACT text you want to CHANGE (old)\n3. Write the MODIFIED version (new) - it must be DIFFERENT from old\n4. If the file already has correct content, the task may be complete - verify and move on."
  },
  "additionalProperties": false,
  "parameters": {
    "path": "string",
    "old": {
      "type": "string",
      "optional": true
    },
    "new": {
      "type": "string",
      "optional": true
    },
    "old_start": {
      "type": "string",
      "optional": true
    },
    "old_end": {
      "type": "string",
      "optional": true
    },
    "all": {
      "type": "boolean",
      "optional": true,
      "default": false
    }
  },
  "handler": "edit"
}
